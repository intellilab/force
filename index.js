(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,function(t,e,a){t.exports={wrap:"h7Turh6o3dTvH_yjTRQeF",bar:"_2_SznPQSNQ8KR8UehWpuVv","align-left":"_3mlLRBb5pGQk1M_cH6FKt2","align-right":"_3b4UvYz4jvVNrpgOEFrjG8",text:"_3oTHlMt_-G1_UXFo2ocvD2",hidden:"_1DAuwZeeY02HR6WZi7E3et"}},,function(t,e,a){t.exports={mask:"_3LhJf0qtn4VD4GmPw7T4Yx",image:"_1H56RpvW0Swo27pbCepUSe"}},,,,,function(t,e,a){t.exports=a.p+"e95592109a80f80efbbae64010511842.jpg"},,,function(t,e,a){t.exports={rect:"IS72-tandQYNw79PQWMg2"}},function(t,e,a){t.exports={wrap:"_3RJ-pxQADVMSGCVJwXgMW9"}},function(t,e,a){t.exports={wrap:"_2S1LkVxaao-3xGU-74Rw9B",panel:"_33dDRgbTwc8h8lKHVVGxLd"}},,,,,,function(t,e,a){},function(t,e,a){"use strict";a.r(e);var n=a(0),s=a.n(n),o=a(6),r=a.n(o),c=a(2),i=a(7),h=a(8),d=a.n(h),l=a(22),u=a(3),m=a.n(u);function p(t){const e=Object(n.useRef)(),a=()=>{const{naturalWidth:a,naturalHeight:n}=e.current,s=a/n,{wrapProps:{width:o,height:r}}=t;let c,i;s>o/r?(i=r,c=Math.floor(s*i)):(c=o,i=Math.floor(c/s));const h=Math.floor((o-c)/2),d=Math.floor((r-i)/2),l=c/a,{onLoad:u}=t;u({el:e.current,width:c,height:i,left:h,top:d,scale:l})},o=Object(l.a)(a,200);Object(n.useEffect)(()=>(window.addEventListener("resize",o,!1),()=>{window.removeEventListener("resize",o,!1)}));const{url:r,wrapProps:c,imageProps:i}=t;if(!r||!c)return null;const{width:h,height:d,top:u,left:p}=i||{};return s.a.createElement("div",null,s.a.createElement("div",{className:m.a.image,style:{width:h,height:d,top:u,left:p}},s.a.createElement("img",{src:r,ref:e,onLoad:a})),s.a.createElement("div",{className:m.a.mask}))}var f=a(10),x=a.n(f),g=a(1),w=a.n(g),v=s.a.forwardRef((t,e)=>{const[a,o]=Object(n.useState)(0),[r,i]=Object(n.useState)(!1),{data:{text:h,style:d,align:l,animated:u}}=t;let m;if(Object(n.useEffect)(()=>{if(!m&&u)return m=new c.Tween({scale:0}).to({scale:1},200).on("update",t=>{o(t.scale)}).on("complete",()=>{i(!0),m=null}).start(),()=>{m&&(m.stop(),m=null)}},[u]),!h)return null;const p=[w.a.wrap,w.a[`align-${l||"left"}`]].join(" ");return s.a.createElement("div",{className:p,style:d,ref:e},s.a.createElement("div",{className:w.a.bar,style:{transform:`scaleX(${a})`}}),s.a.createElement("div",{className:`${w.a.text} ${r?"":w.a.hidden}`},h))}),E=a(11),b=a.n(E);class M extends s.a.Component{constructor(t){super(t),this.handleBind=t=>{this.cache.canvas=t,this.cache.ctx=t?t.getContext("2d"):null},this.handleBindItem=(t,e)=>{this.cache.nodes[t]=e},this.handleMouseDown=t=>{t.preventDefault(),this.dragStart(t)&&(document.addEventListener("mousemove",this.handleMouseMove,!1),document.addEventListener("mouseup",this.handleMouseUp,!1))},this.handleMouseMove=t=>{this.dragMove(t)},this.handleMouseUp=()=>{this.dragEnd()&&(document.removeEventListener("mousemove",this.handleMouseMove,!1),document.removeEventListener("mouseup",this.handleMouseUp,!1))},this.handleTouchStart=t=>{const[e]=t.changedTouches;this.dragStart(e)&&(document.addEventListener("touchmove",this.handleTouchMove,!1),document.addEventListener("touchend",this.handleTouchEnd,!1))},this.handleTouchMove=t=>{const[e]=t.changedTouches;this.dragMove(e)},this.handleTouchEnd=()=>{this.dragEnd()&&(document.removeEventListener("touchmove",this.handleTouchMove,!1),document.removeEventListener("touchend",this.handleTouchEnd,!1))},this.state={items:[]},this.cache={nodes:[]}}componentDidMount(){this.updateData(),this.draw()}componentDidUpdate(t){this.draw(),t!==this.props&&this.updateData()}getOffset(t){const{wrapProps:{top:e,left:a}}=this.props;return{offsetX:t.clientX-a,offsetY:t.clientY-e}}updateItems(){const{items:t}=this.state,e=[[]];t.forEach((t,a)=>{const{data:{tw:n,th:s},rect:o}=t;e[0].push({index:a,x1:o.x1,y1:o.y1,w:n,h:s})});const a=x()({mutationFunction:e=>e.map(e=>{(e={...e}).x1+=3*(Math.floor(3*Math.random())-1),e.y1+=3*(Math.floor(3*Math.random())-1);const a=Math.random(),n=t[e.index];return a<.3?e.x1=2*n.rect.cx-e.x1-e.w:a<.6&&(e.y1=2*n.rect.cy-e.y1-e.h),e}),crossoverFunction:(t,e)=>{const a=Math.floor(t.length/2);return[[...t.slice(0,a),...e.slice(a)],[...e.slice(0,a),...t.slice(a)]]},fitnessFunction:e=>{let a=0;return e.forEach((n,s)=>{t.forEach((t,e)=>{const{dx:o,dy:r,area:c}=y(n,t.rect);if(c)a+=.5*c;else if(s===e){const t=-Math.max(...[o,r].filter(t=>t<0));a+=.5*t}}),e.forEach(t=>{if(n!==t){const{area:e}=y(n,t);e&&(a+=.8*e)}})}),-a},population:e,populationSize:100});for(let t=0;t<100;t+=1)a.evolve();const n=a.best();console.info("best:",n,a.bestScore()),this.setState({items:t.map((t,e)=>({...t,data:{...t.data,align:"left",animated:!0,style:{top:n[e].y1,left:n[e].x1}}}))})}dragStart(t){const{offsetX:e,offsetY:a}=this.getOffset(t),{items:n}=this.state,s=n.findIndex(t=>{const{x1:n,y1:s,w:o,h:r}=t.rect;return e>=n&&e<=n+o&&a>=s&&a<=s+r});if(s>=0){const t={x:e,y:a,index:s,data:n[s]};return this.dragging=t,!0}}dragMove(t){const{dragging:e}=this;if(!e)return;const{offsetX:a,offsetY:n}=this.getOffset(t),{imageProps:s}=this.props,{data:{rect:o}}=e,r=o.x1+a-e.x,c=o.y1+n-e.y,i=S([r,c,r+o.w,c+o.h],{scale:1/s.scale,zoom:1}),h={...e.data,srect:i.rect,rect:i.srect},{items:d}=this.state,l=[...d];l[e.index]=h,this.setState({items:l},this.draw)}dragEnd(){const{dragging:t}=this;if(t)return this.dragging=null,this.updateItems(),!0}updateData(){const{data:t,imageProps:e}=this.props;if(!t)return;const a=t.map(t=>{const{text:a,bbox:n}=t;return{bbox:n,zoom:1,...S(n,{...e,zoom:1}),data:{text:a,style:{right:"100%",bottom:"100%"}}}});this.setState({items:a},()=>{a.forEach((t,e)=>{const a=this.cache.nodes[e];a&&({offsetWidth:t.data.tw,offsetHeight:t.data.th}=a)}),this.updateItems()})}draw(){const{canvas:t,ctx:e}=this.cache;e.clearRect(0,0,t.width,t.height);const{items:a}=this.state,{imageProps:{el:n}}=this.props;a.forEach(({srect:t,rect:a})=>{const{x1:s,y1:o,w:r,h:c}=t,{x1:i,y1:h,w:d,h:l}=a;e.drawImage(n,s,o,r,c,i,h,d,l)})}render(){const{items:t}=this.state,{wrapProps:{width:e,height:a}}=this.props;return s.a.createElement("div",null,s.a.createElement("canvas",{ref:this.handleBind,className:b.a.rect,width:e,height:a,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart}),t.map((t,e)=>s.a.createElement(v,{key:e,data:t.data,ref:t=>this.handleBindItem(e,t)})))}}function y(t,e){const a=Math.max(t.x1,e.x1),n=Math.max(t.y1,e.y1),s=Math.min(t.x1+t.w,e.x1+e.w),o=Math.min(t.y1+t.h,e.y1+e.h);let r=0;const c=s-a,i=o-n;return c>0&&i>0&&(r=c*i),{x1:a,y1:n,x2:s,y2:o,dx:c,dy:i,area:r}}function S([t,e,a,n],s={}){const{scale:o,top:r=0,left:c=0,zoom:i=1}=s,h=a-t,d=n-e,l=h*o,u=d*o,m=l*i,p=u*i,f=c+o*t-(m-l)/2,x=r+o*e-(p-u)/2;return{srect:{x1:t,y1:e,x2:a,y2:n,cx:t+h/2,cy:e+d/2,w:h,h:d},rect:{x1:f,y1:x,x2:f+m,y2:x+p,cx:f+m/2,cy:x+p/2,w:m,h:p}}}var T=a(12),j=a.n(T);const L=[{text:"\u8fd9\u662f\u4e00\u53ea\u773c\u775b",bbox:[450,350,600,450]},{text:"\u8fd9\u662f\u53e6\u4e00\u53ea\u773c\u775b",bbox:[680,400,830,500]},{text:"\u7231",bbox:[720,300,810,400]},{text:"\u8fd9\u662f\u4e00\u53ea\u5927\u624b",bbox:[280,1170,820,1570]}];function O(){const[t,e]=Object(n.useState)(null),[a,o]=Object(n.useState)(null),r=Object(n.useRef)();return Object(n.useEffect)(()=>{const t=r.current.getBoundingClientRect();e(t)},[]),s.a.createElement("div",{className:j.a.wrap,ref:r},s.a.createElement(p,{url:d.a,wrapProps:t,imageProps:a,onLoad:o}),a&&s.a.createElement(M,{wrapProps:t,imageProps:a,data:L}))}var P=a(13),_=a.n(P);a(19);Object(i.a)(),Object(c.autoPlay)(!0);const D=document.createElement("div");document.body.append(D),r.a.render(s.a.createElement((function(){return s.a.createElement("div",{className:_.a.wrap},s.a.createElement(O,null))}),null),D)}],[[20,1,2]]]);